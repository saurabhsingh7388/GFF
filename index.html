<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Downloader</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Ad SDK -->
    <script src='//libtl.com/sdk.js' data-zone='10169742' data-sdk='show_10169742'></script>
    <style>
        /* Enhanced styles for a vibrant, exciting UI */
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulseGlow { 0%, 100% { box-shadow: 0 0 20px rgba(255, 0, 150, 0.3); } 50% { box-shadow: 0 0 40px rgba(255, 0, 150, 0.6); } }
        @keyframes bounceIn { 0% { transform: scale(0.3); opacity: 0; } 50% { transform: scale(1.05); } 70% { transform: scale(0.9); } 100% { transform: scale(1); opacity: 1; } }
        @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .fade-in-up { animation: fadeInUp 0.8s ease-out forwards; }
        .pulse-glow { animation: pulseGlow 2s infinite; }
        .bounce-in { animation: bounceIn 0.6s ease-out forwards; opacity: 0; }
        .float { animation: float 3s ease-in-out infinite; }
        .spin-slow { animation: spin 10s linear infinite; }
        .shimmer-bg { background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%); background-size: 200% 100%; animation: shimmer 2s infinite; }
        .carousel-container { position: relative; overflow: hidden; border-radius: 1.5rem; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .carousel-track { display: flex; transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94); }
        .carousel-slide { min-width: 100%; box-sizing: border-box; }
        .carousel-indicators { position: absolute; bottom: 15px; left: 50%; transform: translateX(-50%); display: flex; gap: 8px; }
        .indicator-dot { width: 10px; height: 10px; border-radius: 50%; background-color: rgba(255,255,255,0.4); cursor: pointer; transition: all 0.3s ease; transform: scale(1); }
        .indicator-dot.active { background: linear-gradient(45deg, #ff6b6b, #ffd93d); transform: scale(1.3); box-shadow: 0 0 10px rgba(255,107,107,0.5); }
        body { scrollbar-width: none; }
        body::-webkit-scrollbar { display: none; }
        .file-card { border: none; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); position: relative; overflow: hidden; }
        .file-card::before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); transition: left 0.5s; }
        .file-card:hover::before { left: 100%; }
        .file-card:hover { transform: translateY(-5px) rotateX(3deg); box-shadow: 0 15px 30px rgba(0,0,0,0.15); }
        .file-card img { animation: float 4s ease-in-out infinite; }
        .download-btn { position: relative; overflow: hidden; }
        .download-btn::after { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); transition: left 0.5s; }
        .download-btn:hover::after { left: 100%; }
        .file-card h3 { animation: fadeInUp 1s ease-out; }
        
        /* Custom animation delays */
        .animation-delay-200 { animation-delay: 200ms; }
        .animation-delay-400 { animation-delay: 400ms; }
        
        /* Telegram modal styles */
        .telegram-modal { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.8); 
            z-index: 10000; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            backdrop-filter: blur(5px);
        }
        .telegram-modal-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            padding: 25px; 
            border-radius: 20px; 
            text-align: center; 
            max-width: 90%; 
            width: 400px;
            color: white;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            border: 2px solid rgba(255,255,255,0.1);
        }
        .telegram-modal h3 {
            color: #ffeb3b; 
            margin-bottom: 15px;
            font-size: 1.5rem;
            font-weight: bold;
        }
        .telegram-instructions {
            background: rgba(255,255,255,0.1); 
            padding: 15px; 
            border-radius: 10px; 
            margin-bottom: 15px;
            text-align: left;
        }
        .telegram-instructions p {
            margin: 8px 0;
            display: flex;
            align-items: center;
        }
        .telegram-instructions .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: #ffeb3b;
            color: #333;
            border-radius: 50%;
            margin-right: 10px;
            font-weight: bold;
        }
        .telegram-link-input {
            width: 100%; 
            padding: 12px; 
            margin: 15px 0; 
            border: none; 
            border-radius: 10px; 
            background: white; 
            color: black;
            font-size: 14px;
        }
        .telegram-modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        .telegram-modal-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .telegram-modal-btn.copy {
            background: #4CAF50; 
            color: white;
        }
        .telegram-modal-btn.close {
            background: #f44336; 
            color: white;
        }
        .telegram-modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-900 via-pink-900 to-red-900 min-h-screen text-white font-sans">

    <div id="app" class="container mx-auto px-4 py-6 max-w-6xl">
        <!-- Header - Vibrant gradient with glow effects -->
        <header class="bg-gradient-to-r from-purple-600 via-pink-500 to-red-500 text-white p-6 rounded-2xl shadow-xl mb-8 relative overflow-hidden fade-in-up pulse-glow">
            <div class="absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23ffffff" fill-opacity="0.05"%3E%3Ccircle cx="30" cy="30" r="2"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')] opacity-50"></div>
            <div class="relative z-10 text-center">
                <h1 data-key="main_title" class="text-4xl font-black mb-4 tracking-wide drop-shadow-xl bg-gradient-to-r from-yellow-300 to-orange-400 bg-clip-text text-transparent">Hacker_zon</h1>
                <p data-key="main_subtitle" class="text-lg text-purple-100 mb-6 max-w-3xl mx-auto leading-relaxed font-light">Dive into a World of Files! Watch Quick Ads, Unlock Secrets, and Download Like a Pro ‚Äì All for Free! üöÄ</p>
                <div class="max-w-xl mx-auto">
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                            <i class="fas fa-search text-yellow-300 text-lg"></i>
                        </div>
                        <input type="text" id="searchInput" data-key-placeholder="search_placeholder" placeholder="üîç Hunt for Epic Files..." class="w-full p-3 pl-12 rounded-2xl bg-white/10 backdrop-blur-md text-white placeholder-purple-200 focus:outline-none focus:ring-4 focus:ring-yellow-400/30 transition-all duration-500 border border-white/20 shimmer-bg">
                    </div>
                </div>
            </div>
        </header>

        <!-- Ad Slot 1 - With fun border -->
        <div id="ad-container-1" class="my-6 flex justify-center min-h-[60px] bg-white/10 rounded-xl p-3 border border-yellow-400/20 bounce-in animation-delay-200"></div>

        <!-- Image Carousel - Neon glow and faster transitions -->
        <div id="slider" class="carousel-container w-full h-48 lg:h-64 bg-gradient-to-r from-purple-800 to-pink-800 rounded-2xl shadow-xl mb-8 fade-in-up animation-delay-200">
            <div id="slider-wrapper" class="carousel-track h-full"></div>
            <div id="slider-dots" class="carousel-indicators"></div>
        </div>

        <!-- Files Section - Dynamic grid with icons -->
        <div class="fade-in-up animation-delay-400">
            <h2 data-key="available_files" class="text-3xl font-black text-white mb-6 flex items-center justify-center gap-3 pb-4 bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent">
                <i class="fas fa-gem text-2xl spin-slow"></i>
                <span>üî• Available Treasures</span>
            </h2>
            <div id="files-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- File cards will be injected here -->
            </div>
            <div id="no-results" class="hidden text-center py-16">
                <i class="fas fa-magic text-6xl text-purple-300 mb-6 animate-pulse float"></i>
                <p data-key="no_results_text" class="text-xl text-purple-200 font-light">No Magic Files Found Yet... Try a Different Spell! ‚ú®</p>
            </div>
        </div>
    </div>

    <!-- Language Selection Modal - Party mode -->
    <div id="language-modal" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="bg-gradient-to-br from-purple-800 to-pink-800 p-8 rounded-2xl shadow-xl text-center fade-in-up max-w-md w-full mx-4 border border-yellow-400/20">
            <h2 class="text-3xl font-black mb-8 text-white bg-gradient-to-r from-yellow-300 to-orange-400 bg-clip-text text-transparent">üåç Pick Your Vibe</h2>
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                <button class="lang-btn px-8 py-4 bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-xl font-bold hover:from-yellow-600 hover:to-orange-600 transition-all duration-500 transform hover:scale-105 shadow-lg pulse-glow" data-lang="en">
                    <i class="fas fa-globe text-lg mb-1 block"></i> English
                </button>
                <button class="lang-btn px-8 py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl font-bold hover:from-purple-600 hover:to-pink-600 transition-all duration-500 transform hover:scale-105 shadow-lg pulse-glow" data-lang="hi">
                    <i class="fas fa-language text-lg mb-1 block"></i> ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä
                </button>
                <button class="lang-btn px-8 py-4 bg-gradient-to-r from-red-500 to-pink-500 text-white rounded-xl font-bold hover:from-red-600 hover:to-pink-600 transition-all duration-500 transform hover:scale-105 shadow-lg pulse-glow" data-lang="bn">
                    <i class="fas fa-font text-lg mb-1 block"></i> ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ
                </button>
            </div>
        </div>
    </div>

    <!-- Telegram Download Instructions Modal -->
    <div id="telegram-download-modal" class="telegram-modal hidden">
        <div class="telegram-modal-content">
            <h3>üì± Download Instructions for Telegram</h3>
            <div class="telegram-instructions">
                <p><span class="step-number">1</span> <strong>Copy the download link below</strong></p>
                <p><span class="step-number">2</span> <strong>Open your browser</strong></p>
                <p><span class="step-number">3</span> <strong>Paste the link and download</strong></p>
            </div>
            <input type="text" id="telegram-download-link" readonly class="telegram-link-input">
            <div class="telegram-modal-buttons">
                <button id="copy-telegram-link" class="telegram-modal-btn copy">
                    <i class="fas fa-copy"></i> Copy Link
                </button>
                <button id="close-telegram-modal" class="telegram-modal-btn close">
                    <i class="fas fa-times"></i> Close
                </button>
            </div>
        </div>
    </div>

    <!-- Footer - Glowy footer -->
    <footer class="bg-black/20 backdrop-blur-md py-6 mt-16 border-t border-purple-500/30">
        <div class="container mx-auto px-4">
            <p class="text-center text-yellow-300 font-bold italic text-lg">‚ö° Powered by Hacker_zon (thakur saurabh) ‚ö°</p>
        </div>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, getDocs, doc, getDoc, query, orderBy } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCeZG22sujctJtU8wXfcGdmeBYxzt07SMM",
            authDomain: "wollet-48fbd.firebaseapp.com",
            databaseURL: "https://wollet-48fbd-default-rtdb.firebaseio.com",
            projectId: "wollet-48fbd",
            storageBucket: "wollet-48fbd.appspot.com",
            messagingSenderId: "158076712000",
            appId: "1:158076712000:web:f49eb93312aba1bb979ba5",
            measurementId: "G-4H73E8CDEZ"
        };
        
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const sliderWrapper = document.getElementById('slider-wrapper');
        const sliderDotsContainer = document.getElementById('slider-dots');
        const filesGrid = document.getElementById('files-grid');
        const searchInput = document.getElementById('searchInput');
        const noResultsMessage = document.getElementById('no-results');
        const languageModal = document.getElementById('language-modal');
        const telegramModal = document.getElementById('telegram-download-modal');
        const telegramDownloadLink = document.getElementById('telegram-download-link');
        const copyTelegramLinkBtn = document.getElementById('copy-telegram-link');
        const closeTelegramModalBtn = document.getElementById('close-telegram-modal');

        let sliderInterval;
        let currentSlide = 0;
        let timerDuration = 10; // Default wait time in seconds
        let currentLang = 'en';

        const translations = {
            en: { 
                main_title: "Thakur saurabh", 
                main_subtitle: "Watch Ads, Unlock, and Download Files for Free!", 
                search_placeholder: "Search for files...", 
                available_files: "Available Files", 
                no_results_text: "No files found matching your search.", 
                no_slides: "No promotional slides available.", 
                slides_error: "Could not load slides.", 
                no_files_uploaded: "No files have been uploaded yet.", 
                files_error: "Could not load files. Please try again later.", 
                unlock_button: "Unlock ({adCount}/{requiredCount})", 
                download_now_button: "Download Now", 
                toast_download_starting: "Your download is starting...", 
                toast_progress: "Progress: {adCount}/{requiredCount}", 
                toast_unlocked: "Download unlocked!", 
                toast_ad_error: "Could not load ad. Please try again.", 
                loading_ad: "Loading ad...", 
                verifying_button: "Please wait {countdown}s",
                telegram_modal_title: "Download Instructions for Telegram",
                telegram_step1: "Copy the download link below",
                telegram_step2: "Open your browser",
                telegram_step3: "Paste the link and download",
                copy_link: "Copy Link"
            },
            hi: { 
                main_title: " ‡§†‡§æ‡§ï‡•Å‡§∞ ‡§∏‡•å‡§∞‡§≠", 
                main_subtitle: "‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® ‡§¶‡•á‡§ñ‡•á‡§Ç, ‡§Ö‡§®‡§≤‡•â‡§ï ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§Æ‡•Å‡§´‡•ç‡§§ ‡§Æ‡•á‡§Ç ‡§´‡§æ‡§á‡§≤‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç!", 
                search_placeholder: "‡§´‡§º‡§æ‡§á‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ñ‡•ã‡§ú‡•á‡§Ç...", 
                available_files: "‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§´‡§æ‡§á‡§≤‡•á‡§Ç", 
                no_results_text: "‡§Ü‡§™‡§ï‡•Ä ‡§ñ‡•ã‡§ú ‡§∏‡•á ‡§ï‡•ã‡§à ‡§´‡§º‡§æ‡§á‡§≤ ‡§Æ‡•á‡§≤ ‡§®‡§π‡•Ä‡§Ç ‡§ñ‡§æ‡§§‡•Ä‡•§", 
                no_slides: "‡§ï‡•ã‡§à ‡§™‡•ç‡§∞‡§ö‡§æ‡§∞ ‡§∏‡•ç‡§≤‡§æ‡§á‡§° ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§", 
                slides_error: "‡§∏‡•ç‡§≤‡§æ‡§á‡§° ‡§≤‡•ã‡§° ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡•Ä‡§Ç‡•§", 
                no_files_uploaded: "‡§Ö‡§≠‡•Ä ‡§§‡§ï ‡§ï‡•ã‡§à ‡§´‡§º‡§æ‡§á‡§≤ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§®‡§π‡•Ä‡§Ç ‡§ï‡•Ä ‡§ó‡§à ‡§π‡•à‡•§", 
                files_error: "‡§´‡§º‡§æ‡§á‡§≤‡•á‡§Ç ‡§≤‡•ã‡§° ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡•Ä‡§Ç‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§", 
                unlock_button: "‡§Ö‡§®‡§≤‡•â‡§ï ({adCount}/{requiredCount})", 
                download_now_button: "‡§Ö‡§≠‡•Ä ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç", 
                toast_download_starting: "‡§Ü‡§™‡§ï‡§æ ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...", 
                toast_progress: "‡§™‡•ç‡§∞‡§ó‡§§‡§ø: {adCount}/{requiredCount}", 
                toast_unlocked: "‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§Ö‡§®‡§≤‡•â‡§ï ‡§π‡•ã ‡§ó‡§Ø‡§æ!", 
                toast_ad_error: "‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® ‡§≤‡•ã‡§° ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡§æ‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§", 
                loading_ad: "‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...", 
                verifying_button: "‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡•á‡§Ç... {countdown}s",
                telegram_modal_title: "Telegram ‡§ï‡•á ‡§≤‡§ø‡§è ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂",
                telegram_step1: "‡§®‡•Ä‡§ö‡•á ‡§¶‡§ø‡§è ‡§ó‡§è ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§≤‡§ø‡§Ç‡§ï ‡§ï‡•ã ‡§ï‡•â‡§™‡•Ä ‡§ï‡§∞‡•á‡§Ç",
                telegram_step2: "‡§Ö‡§™‡§®‡§æ ‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º‡§∞ ‡§ñ‡•ã‡§≤‡•á‡§Ç",
                telegram_step3: "‡§≤‡§ø‡§Ç‡§ï ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç",
                copy_link: "‡§≤‡§ø‡§Ç‡§ï ‡§ï‡•â‡§™‡•Ä ‡§ï‡§∞‡•á‡§Ç"
            },
            bn: { 
                main_title: "Hacker_zon", 
                main_subtitle: "‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®, ‡¶Ü‡¶®‡¶≤‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶¨‡¶ø‡¶®‡¶æ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø‡ßá ‡¶´‡¶æ‡¶á‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®!", 
                search_placeholder: "‡¶´‡¶æ‡¶á‡¶≤‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶®‡ßÅ‡¶∏‡¶®‡ßç‡¶ß‡¶æ‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®...", 
                available_files: "‡¶â‡¶™‡¶≤‡¶¨‡ßç‡¶ß ‡¶´‡¶æ‡¶á‡¶≤", 
                no_results_text: "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶∏‡¶®‡ßç‡¶ß‡¶æ‡¶®‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Æ‡ßá‡¶≤‡ßá ‡¶è‡¶Æ‡¶® ‡¶ï‡ßã‡¶®‡ßã ‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§", 
                no_slides: "‡¶ï‡ßã‡¶® ‡¶™‡ßç‡¶∞‡¶ö‡¶æ‡¶∞‡¶Æ‡ßÇ‡¶≤‡¶ï ‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶° ‡¶â‡¶™‡¶≤‡¶¨‡ßç‡¶ß ‡¶®‡ßá‡¶á‡•§", 
                slides_error: "‡¶∏‡ßç‡¶≤‡¶æ‡¶á‡¶° ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§", 
                no_files_uploaded: "‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§", 
                files_error: "‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶™‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§", 
                unlock_button: "‡¶Ü‡¶®‡¶≤‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶® ({adCount}/{requiredCount})", 
                download_now_button: "‡¶è‡¶ñ‡¶®‡¶á ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®", 
                toast_download_starting: "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", 
                toast_progress: " ‡¶Ö‡¶ó‡ßç‡¶∞‡¶ó‡¶§‡¶ø: {adCount}/{requiredCount}", 
                toast_unlocked: "‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶Ü‡¶®‡¶≤‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!", 
                toast_ad_error: "‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§", 
                loading_ad: "‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", 
                verifying_button: "‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®... {countdown}s",
                telegram_modal_title: "Telegram-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡ßá‡¶∂‡¶ø‡¶ï‡¶æ",
                telegram_step1: "‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï‡¶ü‡¶ø ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®",
                telegram_step2: "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞ ‡¶ñ‡ßÅ‡¶≤‡ßÅ‡¶®",
                telegram_step3: "‡¶≤‡¶ø‡¶ô‡ßç‡¶ï‡¶ü‡¶ø ‡¶™‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®",
                copy_link: "‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®"
            }
        };

        function applyLanguage(lang) {
            currentLang = lang;
            document.documentElement.lang = lang;
            localStorage.setItem('userLanguage', lang);
            document.querySelectorAll('[data-key]').forEach(elem => {
                const key = elem.getAttribute('data-key');
                if (translations[lang][key]) elem.textContent = translations[lang][key];
            });
            document.querySelectorAll('[data-key-placeholder]').forEach(elem => {
                const key = elem.getAttribute('data-key-placeholder');
                if (translations[lang][key]) elem.placeholder = translations[lang][key];
            });
            languageModal.classList.add('hidden');
            loadUserPageData();
        }

        function getText(key, params = {}) {
            let text = translations[currentLang][key] || key;
            for (const param in params) text = text.replace(`{${param}}`, params[param]);
            return text;
        }

        function renderAd(containerId, adCode) {
            if (!adCode) return;
            const container = document.getElementById(containerId);
            if (!container) return;
            container.innerHTML = adCode;
            const scripts = Array.from(container.getElementsByTagName('script'));
            scripts.forEach(oldScript => {
                const newScript = document.createElement('script');
                Array.from(oldScript.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value));
                newScript.appendChild(document.createTextNode(oldScript.innerHTML));
                oldScript.parentNode.replaceChild(newScript, oldScript);
            });
        }

        async function loadBannerAds() {
            try {
                const docRef = doc(db, "settings", "ads");
                const docSnap = await getDoc(docRef);
                if (docSnap.exists()) {
                    const adData = docSnap.data();
                    renderAd('ad-container-1', adData.adSlot1);
                }
            } catch (error) {
                console.error("Error loading banner ads:", error);
            }
        }

        async function loadUserPageData() {
            loadBannerAds();
            try {
                const settingsRef = doc(db, "settings", "general");
                const docSnap = await getDoc(settingsRef);
                if (docSnap.exists()) {
                    timerDuration = docSnap.data().timerDuration || 10;
                }
            } catch (error) {
                console.error("Could not fetch settings, using defaults.", error);
            }

            try {
                const q = query(collection(db, "sliders"), orderBy("createdAt", "desc"));
                const sliderSnapshot = await getDocs(q);
                sliderWrapper.innerHTML = '';
                sliderDotsContainer.innerHTML = '';
                const slides = [];
                sliderSnapshot.forEach(doc => slides.push(doc.data()));
                if (slides.length > 0) {
                    slides.forEach((slide, index) => {
                        const slideEl = document.createElement('div');
                        slideEl.className = 'carousel-slide';
                        const imageHTML = `<img src="${slide.imageUrl}" class="w-full h-full object-cover rounded-2xl" onerror="this.onerror=null;this.src='https://placehold.co/1280x400/ff6b6b/ffffff?text=üöÄ+Slide+Not+Found';">`;
                        slideEl.innerHTML = slide.linkUrl ? `<a href="${slide.linkUrl}" target="_blank" rel="noopener noreferrer" class="block w-full h-full">${imageHTML}</a>` : imageHTML;
                        sliderWrapper.appendChild(slideEl);
                        const dotEl = document.createElement('div');
                        dotEl.className = 'indicator-dot';
                        dotEl.dataset.index = index;
                        sliderDotsContainer.appendChild(dotEl);
                    });
                    setupSlider(slides.length);
                } else {
                    sliderWrapper.innerHTML = `<div class="carousel-slide flex items-center justify-center bg-gradient-to-r from-purple-700 to-pink-700 rounded-2xl"><p class="text-yellow-300 font-bold text-lg">${getText('no_slides')}</p></div>`;
                }
            } catch (error) {
                console.error("Error loading sliders:", error);
                sliderWrapper.innerHTML = `<div class="carousel-slide flex items-center justify-center bg-gradient-to-r from-red-700 to-pink-700 rounded-2xl"><p class="text-yellow-300 font-bold text-lg">${getText('slides_error')}</p></div>`;
            }
            
            try {
                const q = query(collection(db, "files"), orderBy("createdAt", "desc"));
                const filesSnapshot = await getDocs(q);
                filesGrid.innerHTML = '';
                if (filesSnapshot.empty) {
                    filesGrid.innerHTML = `<p class="col-span-full text-center text-purple-300 font-bold py-10 text-xl">${getText('no_files_uploaded')}</p>`;
                    return;
                }
                const files = [];
                filesSnapshot.forEach(doc => files.push({ id: doc.id, ...doc.data() }));
                files.forEach((file, index) => {
                    const delay = index * 150; // Staggered animation
                    const card = document.createElement('div');
                    card.className = `file-card bg-gradient-to-br from-purple-800 to-pink-800 rounded-2xl overflow-hidden bounce-in relative ${delay > 0 ? `animation-delay-${delay}ms` : ''}`;
                    card.dataset.title = file.title.toLowerCase();
                    card.dataset.description = file.description.toLowerCase();
                    card.innerHTML = `
                        <img src="${file.thumbnailUrl}" alt="${file.title}" class="w-full aspect-video object-cover" onerror="this.onerror=null;this.src='https://placehold.co/400x225/ff6b6b/ffffff?text=üî•+No+Image';">
                        <div class="p-4 relative z-10">
                            <h3 class="text-xl font-black text-white mb-2 truncate bg-gradient-to-r from-yellow-300 to-orange-400 bg-clip-text" title="${file.title}">${file.title}</h3>
                            <p class="text-purple-200 text-sm mb-4 line-clamp-2">${file.description}</p>
                            <button data-id="${file.id}" data-url="${file.downloadUrl}" data-required-ads="${file.requiredAds || 10}" data-filename="${file.title || 'file'}" class="download-btn w-full py-3 px-4 rounded-xl text-white font-bold transition-all duration-500 shadow-xl flex items-center justify-center gap-3 relative overflow-hidden">
                                <i class="fas text-lg"></i>
                                <span class="relative z-10"></span>
                            </button>
                        </div>
                    `;
                    filesGrid.appendChild(card);
                    updateButtonState(card.querySelector('.download-btn'));
                });
            } catch (error) {
                console.error("Error loading files:", error);
                filesGrid.innerHTML = `<p class="col-span-full text-center text-red-300 font-bold py-10 text-xl">${getText('files_error')}</p>`;
            }
        }

        function setupSlider(slideCount) {
            if (slideCount <= 1) {
                if(slideCount === 1) document.querySelector('.indicator-dot').classList.add('active');
                return;
            };
            const dots = document.querySelectorAll('.indicator-dot');
            function goToSlide(slideIndex) {
                currentSlide = (slideIndex + slideCount) % slideCount;
                sliderWrapper.style.transform = `translateX(-${currentSlide * 100}%)`;
                dots.forEach(dot => dot.classList.remove('active'));
                if(dots[currentSlide]) dots[currentSlide].classList.add('active');
            }
            if (sliderInterval) clearInterval(sliderInterval);
            sliderInterval = setInterval(() => goToSlide(currentSlide + 1), 2500); // Faster for excitement
            dots.forEach(dot => dot.addEventListener('click', (e) => goToSlide(parseInt(e.target.dataset.index))));
            goToSlide(0);
        }

        function updateButtonState(button) {
            const fileId = button.dataset.id;
            const requiredCount = parseInt(button.dataset.requiredAds);
            const adCount = parseInt(localStorage.getItem(`adCount_${fileId}`) || 0);
            const isUnlocked = adCount >= requiredCount;
            const buttonTextEl = button.querySelector('span');
            const buttonIconEl = button.querySelector('i');
            button.disabled = false;
            const lockedColors = ['bg-gradient-to-r', 'from-purple-600', 'to-pink-600', 'hover:from-purple-700', 'hover:to-pink-700'];
            const unlockedColors = ['bg-gradient-to-r', 'from-yellow-500', 'to-orange-500', 'hover:from-yellow-600', 'hover:to-orange-600'];
            button.classList.remove(...lockedColors, ...unlockedColors);
            if (isUnlocked) {
                buttonTextEl.textContent = getText('download_now_button');
                buttonIconEl.className = 'fas fa-rocket text-lg';
                button.classList.add(...unlockedColors);
            } else {
                buttonTextEl.textContent = getText('unlock_button', { adCount, requiredCount });
                buttonIconEl.className = 'fas fa-gem text-lg';
                button.classList.add(...lockedColors);
            }
        }

        // Check if user is in Telegram
        function isTelegramWebView() {
            return /Telegram/.test(navigator.userAgent);
        }

        function handleDownloadClick(e) {
            const button = e.target.closest('.download-btn');
            if (!button || button.disabled) return;
            const fileId = button.dataset.id;
            const downloadUrl = button.dataset.url;
            const filename = button.dataset.filename;
            const requiredCount = parseInt(button.dataset.requiredAds);
            const adCount = parseInt(localStorage.getItem(`adCount_${fileId}`) || 0);
            
            if (adCount >= requiredCount) {
                if (isTelegramWebView()) {
                    // Telegram WebView mein special handling
                    showTelegramDownloadModal(downloadUrl, filename);
                } else {
                    // Normal browser download
                    handleNormalDownload(downloadUrl, filename);
                }
                return;
            }
            processAdUnlock(button);
        }

        function handleNormalDownload(downloadUrl, filename) {
            // Force immediate download for base64 URL
            const a = document.createElement('a');
            a.href = downloadUrl;
            a.download = filename + '.zip';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        function showTelegramDownloadModal(downloadUrl, filename) {
            // Update modal content with current language
            telegramModal.querySelector('h3').textContent = getText('telegram_modal_title');
            
            const instructions = telegramModal.querySelector('.telegram-instructions');
            instructions.innerHTML = `
                <p><span class="step-number">1</span> <strong>${getText('telegram_step1')}</strong></p>
                <p><span class="step-number">2</span> <strong>${getText('telegram_step2')}</strong></p>
                <p><span class="step-number">3</span> <strong>${getText('telegram_step3')}</strong></p>
            `;
            
            copyTelegramLinkBtn.innerHTML = `<i class="fas fa-copy"></i> ${getText('copy_link')}`;
            
            telegramDownloadLink.value = downloadUrl;
            telegramModal.classList.remove('hidden');
        }

        async function processAdUnlock(button) {
            button.disabled = true;
            const buttonTextEl = button.querySelector('span');
            const fileId = button.dataset.id;
            const requiredCount = parseInt(button.dataset.requiredAds);
            let adCount = parseInt(localStorage.getItem(`adCount_${fileId}`) || 0);
            try {
                buttonTextEl.textContent = getText('loading_ad');
                await show_10169742();
                adCount++;
                localStorage.setItem(`adCount_${fileId}`, adCount);
                if (adCount >= requiredCount) {
                    updateButtonState(button);
                    return;
                }
                let countdown = timerDuration;
                buttonTextEl.textContent = getText('verifying_button', { countdown });
                const timerInterval = setInterval(() => {
                    countdown--;
                    if (countdown > 0) {
                        buttonTextEl.textContent = getText('verifying_button', { countdown });
                    } else {
                        clearInterval(timerInterval);
                        updateButtonState(button);
                    }
                }, 1000);
            } catch (err) {
                console.error("Ad error:", err);
                updateButtonState(button);
            }
        }

        function handleSearch() {
            const searchTerm = searchInput.value.toLowerCase();
            const fileCards = document.querySelectorAll('.file-card');
            let visibleCount = 0;
            fileCards.forEach(card => {
                const title = card.dataset.title;
                const description = card.dataset.description;
                if (title.includes(searchTerm) || description.includes(searchTerm)) {
                    card.style.display = 'block';
                    visibleCount++;
                } else {
                    card.style.display = 'none';
                }
            });
            noResultsMessage.style.display = visibleCount === 0 ? 'block' : 'none';
        }

        // Copy Telegram download link
        copyTelegramLinkBtn.addEventListener('click', function() {
            telegramDownloadLink.select();
            document.execCommand('copy');
            
            // Show feedback
            const originalText = this.innerHTML;
            this.innerHTML = '<i class="fas fa-check"></i> Copied!';
            this.style.background = '#2E7D32';
            
            setTimeout(() => {
                this.innerHTML = originalText;
                this.style.background = '';
            }, 2000);
        });

        // Close Telegram modal
        closeTelegramModalBtn.addEventListener('click', function() {
            telegramModal.classList.add('hidden');
        });

        // Close modal when clicking outside
        telegramModal.addEventListener('click', function(e) {
            if (e.target === this) {
                telegramModal.classList.add('hidden');
            }
        });

        window.addEventListener('load', () => {
            const savedLang = localStorage.getItem('userLanguage');
            if (savedLang && translations[savedLang]) {
                applyLanguage(savedLang);
            } else {
                languageModal.classList.remove('hidden');
            }
        });

        filesGrid.addEventListener('click', handleDownloadClick);
        searchInput.addEventListener('input', handleSearch);
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.addEventListener('click', () => applyLanguage(btn.dataset.lang));
        });
    </script>
</body>
</html>